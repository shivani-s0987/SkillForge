import{r,j as e,b as S,a6 as D,a7 as k,a9 as h,aa as g,ab as C,ac as R,ad as F,d as p,c as P,ae as z,af as T}from"./index-B4p9qEZL.js";const E=()=>{const[a,u]=r.useState(null),[l,f]=r.useState(null),[n,j]=r.useState([]),[d,o]=r.useState(!1),c=r.useRef(null),N=async()=>{if(!a||!l){p(300,"Please select both start and end dates.");return}o(!0);try{const s=await P.get(`admin/sales-report/?start=${a.toISOString()}&end=${l.toISOString()}`);j(s.data.sales||[])}catch(s){console.error("Failed to fetch sales data:",s),p(500,"Failed to fetch sales data. Please try again.")}finally{o(!1)}},y=()=>n.reduce((s,t)=>s+t.total_sales,0),b=()=>n.reduce((s,t)=>s+parseFloat(t.total_amount),0).toFixed(2),w=()=>{c.current&&z(c.current).then(s=>{const t=s.toDataURL("image/png"),i=new T,m=i.getImageProperties(t),x=i.internal.pageSize.getWidth(),v=m.height*x/m.width;i.addImage(t,"PNG",0,0,x,v),i.save("sales_summary.pdf")})};return e.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6 mt-10",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-4 flex flex-col sm:flex-row justify-between items-center",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-700 mb-2 sm:mb-0",children:"Sales Report"})}),e.jsx("nav",{className:"flex mb-8","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[e.jsx("li",{className:"inline-flex items-center",children:e.jsxs(S,{to:"/admin",className:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-indigo-600",children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Dashboard"]})}),e.jsx("li",{"aria-current":"page",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"ml-1 text-sm font-medium text-gray-500 md:ml-2",children:"Sales Report"})]})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx(h,{selected:a,onChange:s=>u(s),className:"p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholderText:"Select Start Date",dateFormat:"yyyy-MM-dd",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx(h,{selected:l,onChange:s=>f(s),className:"p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholderText:"Select End Date",dateFormat:"yyyy-MM-dd",required:!0})]})]}),e.jsx("button",{onClick:N,className:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out flex items-center",disabled:d,children:d?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"mr-2",size:20}),"Generate Report"]})})]})}),n.length>0?e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-800",children:"Sales Summary"}),e.jsx("div",{className:"space-x-2",children:e.jsxs("button",{onClick:w,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out flex items-center",children:[e.jsx(C,{className:"mr-2",size:20}),"Download PDF"]})})]}),e.jsxs("div",{ref:c,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-100 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"text-blue-500 mr-2",size:24}),e.jsx("span",{className:"text-lg font-semibold text-blue-700",children:"Date Range"})]}),e.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:[a==null?void 0:a.toLocaleDateString()," -"," ",l==null?void 0:l.toLocaleDateString()]})]}),e.jsxs("div",{className:"bg-green-100 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"text-green-500 mr-2",size:24}),e.jsx("span",{className:"text-lg font-semibold text-green-700",children:"Total Sales"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-green-600",children:y()})]}),e.jsxs("div",{className:"bg-purple-100 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"text-purple-500 mr-2",size:24}),e.jsx("span",{className:"text-lg font-semibold text-purple-700",children:"Total Revenue"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-purple-600",children:b()})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SI"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Sales"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s==null?void 0:s.course_title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s==null?void 0:s.total_sales}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s==null?void 0:s.total_amount})]},t))})]})})]})]}):e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:e.jsx("p",{className:"text-lg text-gray-500",children:"No data to display. Please generate a report."})})]})})};export{E as default};
