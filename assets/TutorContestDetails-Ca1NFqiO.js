import{au as _,A as k,a as A,aU as S,a4 as j,r as q,j as e,b as h,a6 as R,a7 as g,w as p,aV as T,aW as $,S as f,c as N,d as n}from"./index-FF5MpAmF.js";/**
 * @license lucide-react v0.436.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=_("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Q=()=>{var x,u;const{id:a}=k(),l=A(),{contestDetails:s,error:d,loading:b}=S(a),{user:r}=j(t=>t.auth),[o,m]=q.useState(!1),y=()=>{l(`/tutor/contest/${a}/edit`)},v=t=>{l(`/tutor/contest/${a}/question/${t}/edit`)},w=(s==null?void 0:s.status)==="finished"||(s==null?void 0:s.end_time)&&new Date(s.end_time)<new Date,C=async()=>{if((await f.fire({title:"Send contest progress reports to all students?",text:"This will email each student's contest progress using the stored contest_report.html template. Emails will be queued and sent sequentially (10s spacing). Continue?",icon:"warning",showCancelButton:!0,confirmButtonText:"Send Reports"})).isConfirmed)try{m(!0);const i=await N.post(`contest/${a}/send-progress-reports/`);i.status===202?n(202,"Progress reports have been queued and will be delivered to students."):i.status===200&&n(200,"Progress reports processed successfully")}catch(i){console.error(i),n(500,"Failed to queue progress reports. Please try again."),m(!1)}};return b?e.jsx("div",{className:"text-center text-gray-500 my-8",children:"Loading..."}):d?e.jsx("div",{className:"text-center text-red-500 my-8",children:d}):s?e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("nav",{className:"flex mb-8","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[e.jsx("li",{className:"inline-flex items-center",children:e.jsxs(h,{to:"/tutor",className:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-indigo-600",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Dashboard"]})}),e.jsx("li",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"h-5 w-5 text-gray-400"}),e.jsx(h,{to:"/tutor/contest",className:"ml-1 text-sm font-medium text-gray-700 hover:text-indigo-600 md:ml-2",children:"Contests"})]})}),e.jsx("li",{"aria-current":"page",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"ml-1 text-sm font-medium text-gray-500 md:ml-2",children:s.name})]})})]})}),e.jsxs("div",{className:"bg-white border rounded-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 sm:mb-0",children:s.name}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s.status==="ongoing"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s!=null&&s.status?s.status.charAt(0).toUpperCase()+s.status.slice(1):""}),w&&((r==null?void 0:r.is_staff)||(r==null?void 0:r.role)==="tutor")&&e.jsx("button",{onClick:C,disabled:o,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded transition duration-150 ease-in-out ml-4",children:o?"Queuing...":"Send Progress Reports"})]})]}),s.end_time&&new Date(s.end_time)<new Date&&e.jsx("div",{className:"mb-4",children:e.jsx(E,{})}),e.jsx("p",{className:"text-gray-700",children:s.description})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-2 sm:mb-0",children:"Contest Details"}),e.jsx("button",{onClick:y,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-medium px-4 py-2 rounded transition duration-150 ease-in-out",children:"Edit Contest"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Total Questions"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.total_questions})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Max Points"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.max_points})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Category"}),e.jsx("p",{className:"text-gray-800 font-medium",children:((x=s.category)==null?void 0:x.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Time Limit"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.time_limit?`${s.time_limit} minutes`:"No limit"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Start Time"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s.start_time?p(new Date(s.start_time)):"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"End Time"}),e.jsx("p",{className:"text-gray-800 font-medium",children:s!=null&&s.end_time?p(new Date(s==null?void 0:s.end_time)):"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Questions"}),((u=s.questions)==null?void 0:u.length)>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:s.questions.map((t,i)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:`Q${i+1}: ${t.question_text}`}),e.jsx("button",{onClick:()=>v(t.id),className:"text-indigo-600 hover:text-indigo-700 transition duration-150 ease-in-out",children:e.jsx(T,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"ml-4",children:t.options.map(c=>e.jsxs("div",{className:"flex items-center mb-2",children:[c.is_correct?e.jsx($,{className:"h-5 w-5 text-green-500 mr-2"}):e.jsx(B,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("span",{className:`text-gray-700 ${c.is_correct?"font-medium":""}`,children:c.option_text})]},c.id))})]},t.id))}):e.jsx("p",{className:"text-gray-500",children:"No questions available for this contest."})]})]}):e.jsx("div",{className:"text-center text-gray-500 my-8",children:"No contest details found."})},E=()=>{const{user:a}=j(l=>l.auth);return!a||!a.is_staff&&a.role!=="tutor"?null:e.jsx("button",{onClick:async()=>{if((await f.fire({title:"Regenerate AI summaries for all contests?",text:"This will regenerate AI summaries for every contest. Continue?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, regenerate"})).isConfirmed)try{const s=await N.post("summarizedkeynotes/generate_all/");s.status===202?n(202,"Regeneration queued and running in background"):s.status===200&&n(200,"Regeneration completed")}catch(s){console.error(s),n(500,"Failed to regenerate summaries")}},className:"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600",children:"Generate AI Key Notes (All Contests)"})};export{Q as default};
